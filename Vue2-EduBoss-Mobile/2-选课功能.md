### â­é€‰è¯¾åŠŸèƒ½

ğŸ• å®ç°æ­¥éª¤ï¼š

> â­é¡¶éƒ¨ä¿¡æ¯å¤„ç† --> å¹¿å‘Šè½®æ’­å›¾å¤„ç† --> è¯¾ç¨‹ä¿¡æ¯å¤„ç† --> åº•éƒ¨å…¬å…±ç»„ä»¶å¼•å…¥â­

```vue
<!--course/index.vue-->
<template>
  <div class="course">
    <course-header></course-header>
    <course-content></course-content>
    <layout-footer></layout-footer>
  </div>
</template>
<script>
  import CourseHeader from './components/CourseHeader.vue'
  import CourseContent from './components/CourseHeader.vue'
  import LayoutFooter from '@/components/LayoutFooter.vue'
  export default {
    name: 'course-index',
    components: {
      CourseHeader,
      CourseContent,
      LayoutFooter
    }
  }
</script>
```

#### 1ã€é¡¶éƒ¨Logo

ğŸ• å®ç°æ­¥éª¤ï¼š

> â­ä½¿ç”¨`van-image`ç»„ä»¶å¸ƒå±€å¤„ç†ï¼Œç„¶ååšå…·ä½“æ ·å¼è®¾ç½®â­
>

ğŸ–ï¸ æ³¨æ„ï¼š`Vant`çš„ç»„ä»¶åä¹Ÿæ˜¯è®¾ç½®æ ·å¼çš„ç±»å

```vue
<!--course/components/CourseHeader.vue-->
<template>
  <div class="course-header">
    <van-image :src="require('@/assets/logo.png')"></van-image>
  </div>
</template>
<script>
export default {
  name: 'course-header'
}
</script>
<style lang="scss" scoped>
.course-header{
  height: 50px;
}
.van-image{
  width: 180px;
  margin-left: -20px;
}
</style>
```

#### 2ã€è½®æ’­å›¾å±•ç¤ºä¸è¯¾ç¨‹ä¿¡æ¯å±•ç¤º

##### 2.1ã€å¹¿å‘Šè½®æ’­å›¾

ğŸ• å®ç°æ­¥éª¤ï¼š

> â­ å¹¿å‘Šè½®æ’­åŒºåŸŸçš„é™æ€å¸ƒå±€å¤„ç† --> è½®æ’­å›¾æ•°æ®çš„è¯·æ±‚ --> å¯¹åº”æ•°æ®çš„ç»‘å®š â­
>
> ä½¿ç”¨`van-swipe`ç»„ä»¶åšè½®æ’­åŠŸèƒ½ï¼Œ`autoplay`æ§åˆ¶è‡ªåŠ¨åˆ‡æ¢æ—¶é—´ï¼Œ`indicator-color`æ§åˆ¶åº•éƒ¨åœ†ç‚¹é¢œè‰²ï¼›

```vue
<!--course/components/CourseContent.vue-->
<template>
  <div class="course-content">
    <van-swipe class="my-swipe" :autoplay="3000" indicator-color="orange">
      <van-swipe-item v-for="item in activeAdList" :key="item.id">
        <img :scr="item.img">
  		</van-swipe-item>
    </van-swipe>
  </div>
</template>
<script>
//è¯·æ±‚çš„æ•°æ®æ¥å£å¼•å…¥ï¼Œé‡‡ç”¨è§£æ„çš„å½¢å¼ï¼Œç„¶ååœ¨ç»„ä»¶createdé’©å­åŠ è½½æ—¶æ‰§è¡Œå‘é€è¯·æ±‚ï¼Œå¾—åˆ°æ•°æ®åè¿›è¡Œç»‘å®š
import { getAllAds } from '@/services/course.js'
export default {
  name: 'course-content',
  components: {
    CourseContentList
  },
  //è¦è¿›è¡Œæ•°æ®ç»‘å®šï¼Œéœ€è¦å…ˆè¿›è¡Œæ•°æ®å­˜å‚¨
  data () {
    return {
      adList: []
    }
  },
  //å®šä¹‰loadAdsæ–¹æ³•æ¥è¿›è¡Œå¹¿å‘Šèµ„æºçš„è¯·æ±‚
  created () {
    this.loadAds()
  },
  //è¯·æ±‚çš„å…·ä½“é€»è¾‘å°è£…åœ¨methodsä¸­çš„loadAdsæ–¹æ³•ä¸­ï¼Œä¸”ä½¿ç”¨asyncå¼‚æ­¥å¤„ç†çš„æ–¹å¼
  methods: {
    async loadAds () {
      const { data } = await getAllAds({
        spaceKeys: '999'
      })
      //æŠŠè¯·æ±‚è·å–çš„æ•°æ®å­˜å‚¨åœ¨dataä¸­çš„adListå·²å¤‡å¯¹åº”ç»‘å®šä½¿ç”¨
      this.adList = data.content[0].adDTOList
    }
  },
  //åˆ©ç”¨è®¡ç®—å±æ€§çš„ç¼“å­˜æ€§ç­›é€‰è®°å½•å·²ä¸Šæ¶çš„å¹¿å‘Šä¿¡æ¯ç”¨äºéå†ç»‘å®š
  computed: {
    activeAdList () {
      return this.adList.filter(item => item.status === 1)
    }
  }
}
</script>
<style lang="scss" scoped>
  .my-swipe {
    width: 100%
  }
  .my-swipe .van-swipe-item {
    display: flex;
    justify-content: center;
    overflow: hidden;
  }
  .my-swipe img {
    height: 170px;
  }
</style>
```

```js
// services/course.js
import request from '@/utils/request'
// è·å–å¯¹åº”å¹¿å‘Šçš„è¯·æ±‚æ¥å£
export const getAllAds = params => {
  return request({
    method: 'GET',
    url: '/front/ad/getAllAds',
    params
  })
}
```

##### 2.2ã€è¯¾ç¨‹åˆ—è¡¨å±•ç¤º

```vue
<!--course/components/CourseContent.vue-->
<template>
  <course-content-list></course-content-list>
</template>
<script>
//å¼•å…¥ç»„ä»¶å¹¶æ³¨å†Œä½¿ç”¨
import CourseContentList from './CourseContentList.vue'
export default {
	name: 'CourseContent',
  components: {
    CourseContentList
  }
}
</script>
<style lang="scss" scpoed>
  //è®¾ç½®ä¸Šä¸‹çš„å…·ä½“åˆ—è¡¨æ»šåŠ¨æ˜¾ç¤ºèŒƒå›´
  .course-content-list {
    top: 180px;
    bottom: 60px;
  }
</style>
```

ğŸ• å®ç°æ­¥éª¤ï¼š

> â­åŸºç¡€å¸ƒå±€å¤„ç† --> è¯¾ç¨‹æ•°æ®çš„è·å– --> å¯¹åº”æ•°æ®çš„ç»‘å®šâ­
>
> éœ€è¦å•ç‹¬å°è£…æˆç‹¬ç«‹ç»„ä»¶ï¼Œä¾¿äºåç»­å¤ç”¨ï¼›
>
> ä½¿ç”¨`van-list`ç»„ä»¶è¿›è¡Œå¸ƒå±€ï¼Œä½¿ç”¨`loading`ã€è§¦åº•åŠ è½½ã€‘å’Œ`finished`ã€æ•°æ®å…¨éƒ¨åŠ è½½ã€‘æ¥æ§åˆ¶åŠ è½½çŠ¶æ€ï¼Œä½¿ç”¨`van-pull-refresh`ç»„ä»¶è¿›è¡ŒåŒ…è£¹è®¾ç½®ä¸‹æ‹‰åˆ·æ–°æ•ˆæœï¼Œ`onLoad`è´Ÿè´£è§¦å‘æ•°æ®è¯·æ±‚

```vue
<!--course/components/CourseContentList.vue-->
<template>
  <div class="course-content-list">
    <van-pull-refresh v-model="isRefreshing" @refresh="onRefresh">
      <van-list v-model="loading" :finished="finished"
        finished-text="æ²¡æœ‰æ›´å¤šäº†" @load="onLoad">
        <van-cell v-for="item in list" :key="item.id"
          @click="$router.push({ name: 'course-info',
          	params: { courseId: item.id }})">
          <div>
            <img :src="item.courseImgUrl || item.image">
          </div>
          <div class="course-info">
            <h3 v-text="item.courseName || item.name"></h3>
            <p class="course-preview" v-html="item.previewFirstField"></p>
            <p v-if="item.price" class="price-container">
              <span class="course-discounts">${{ item.discounts }}</span>
              <s class="course-price">${{ item.price }}</s>
            </p>
          </div>
        </van-cell>
      </van-list>
    </van-pull-refresh>
  </div>
</template>
<script>
//ä½¿ç”¨è§£æ„çš„æ–¹å¼å¼•å…¥è¯·æ±‚æ•°æ®æ¥å£
import { getQueryCourses } from '@/services/course.js'
export default {
  name: 'course-content-list',
  data () {
    return {
      list: [],//ç”¨äºå­˜å‚¨è¿½åŠ çš„æ•°æ®
      loading: false,//æ˜¯å¦å¤„äºåŠ è½½ä¸­
      finished: false,//æ£€æµ‹æ˜¯å¦å…¨éƒ¨åŠ è½½å®Œæ¯•
      currentPage: 1,//æ•°æ®é¡µæ•°
      isRefreshing: false//æ˜¯å¦å¤„äºåŠ è½½çŠ¶æ€
    }
  },
  methods: {
    async onLoad () {//å‘é€æ•°æ®è¯·æ±‚ï¼Œè·å–çš„æ•°æ®å­˜å‚¨åœ¨dataä¸­å¤‡ç”¨
      const { data } = await this.getQueryCourses({
        currentPage: this.currentPage,//å½“å‰é¡µå·
        pageSize: 10,//è¯·æ±‚æ•°æ®çš„æ¡æ•°
        status: 1//è¯¾ç¨‹çŠ¶æ€ï¼Œ1ä»£è¡¨ä¸Šæ¶çŠ¶æ€
      })
      //console.log(data)//å¯ä»¥æŸ¥çœ‹åˆ°å¯¹åº”çš„ç»‘å®šæ•°æ®ä¿¡æ¯
      //åšä¸€æ¬¡åˆ¤æ–­å¤„ç†
      if (data.data && data.data.records && data.data.records.length !== 0) {
        this.list.push(...data.data.records)//è¿½åŠ æ•°æ®åˆ°dataçš„listä¸­
      }
      this.currentPage++//ä¸‹æ¬¡è¯·æ±‚ä¸‹ä¸€é¡µæ•°æ®
      this.loading = false//æ•°æ®åŠ è½½çŠ¶æ€ç»“æŸ
      //æ•°æ®å…¨éƒ¨åŠ è½½å®Œæˆï¼Œåœæ­¢è¯·æ±‚æ“ä½œ
      if (data.data.records.length < 10) {
        this.finished = true
      }
    },
    //åˆ—è¡¨åˆ·æ–°æ•ˆæœçš„è‡ªå®šä¹‰äº‹ä»¶æ–¹æ³•
    async onRefresh () {
      //å…ˆé‡ç½®æ•°æ®é¡µæ•°ä¸º1
      this.currentPage = 1
      //å†åœ¨åˆ·æ–°çš„æ—¶å€™è¿›è¡Œæ•°æ®çš„é‡æ–°è¯·æ±‚
      const { data } = await this.fetchData({
        currentPage: this.currentPage,
        pageSize: 10,
        status: 1
      })
      //åˆ¤æ–­recordsçš„æ•°æ®ï¼Œç„¶åå†è¿›è¡Œæ•°æ®çš„è¯·æ±‚æ“ä½œ
      if (data.data && data.data.records && data.data.records.length !== 0) {
        this.list = data.data.records//ä¸‹æ‹‰åˆ·æ–°ï¼Œæ¸…é™¤æ‰€æœ‰æ•°æ®ï¼Œç›´æ¥èµ‹å€¼ç»™this.list
      } else if (data.content && data.content.length !== 0) {
        this.list = data.content
      }
      this.$toast('åˆ·æ–°æˆåŠŸ')//ä½¿ç”¨è½»æç¤ºå±•ç¤ºæç¤ºä¿¡æ¯
      this.isRefreshing = false//å…³é—­ä¸‹æ‹‰æç¤ºæ¡†
    }
  }
}
</script>
<style lang="scss" scoped>
//åˆ—è¡¨å›ºå®šä½ç½®å¤„ç†
.course-content-list {
  position: fixed;
  overflow-y: auto;//çºµå‘æ»šåŠ¨æ¡
  //è®¾ç½®æ»šåŠ¨åŒºåŸŸçš„æ»šé¡¶èŒƒå›´ï¼Œè¿™æ˜¯åŸå§‹å€¼ï¼Œå…·ä½“å€¼éœ€è¦åœ¨ä½¿ç”¨é¡µé¢è®¾ç½®
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
}
//è®¾ç½®flexå¸ƒå±€ï¼Œè¿›è¡Œå·¦å³å±•ç¤º
.van-cell__value {
  display: flex;
  height: 100px;
  padding: 10px 0;
}
.van-cell__value img {
  height: 100%;
  width: 85px;
  border-radius: 5px;
}
//è®¾ç½®flexå¸ƒå±€ï¼Œè¿›è¡Œä¸Šä¸‹æ’åˆ—å±•ç¤º
.course-info {
  flex: 1;
  display: flex;
  flex-direction: column;
  padding: 0 10px;
}
//å¤šè¡Œæ–‡æœ¬æº¢å‡ºéšè—
.course-info .course-preview {
  flex: 1;
  overflow: hidden;
  text-overflow: ellipsis;
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
}
.course-info .course-discounts {
  color: #ff7452;
  margin-right: 10px;
}
p, h3 { margin: 0; }
</style>
```

è·å–è¯¾ç¨‹å†…å®¹çš„æ¥å£å°è£…

```js
// services/course.js
//åˆ†é¡µæŸ¥è¯¢è¯¾ç¨‹å†…å®¹æ¥å£
export const getQueryCourses = data => {
  return request({
    method: 'POST',
    url: '/front/course/getQueryCourses',
    data
  })
}
```
